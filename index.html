<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
    <title>replace the title</title>
</head>
<body>
<div class="container-fluid">
    <!-- 1 -->
    <div class="row">
        <div class="col-12 text-center bg-info">
            <h2>LogIn</h2>
        </div>
    </div>

    <!-- The form -->
    <div class="row">
        <div class="col-4"></div>
        <div class="col-4">
            <form class="row g-3" method="post" action="#" onsubmit="save_email()">
                <div class="col-md-6 prev-clicked">
                    <label for="First-Name" class="form-label">First name</label>
                    <input type="text" class="form-control" id="First-Name">
                    <div class="good-val-fu alert alert-success d-none">Looks good!</div>
                    <div class="bad-val-fu alert alert-danger d-none"></div>
                </div>
                <div class="col-md-6 prev-clicked">
                    <label for="Last-Name" class="form-label">Last name</label>
                    <input type="text" class="form-control" id="Last-Name">
                    <div class="good-val-lu alert alert-success d-none">Looks good!</div>
                    <div class="bad-val-lu alert alert-danger d-none"></div>
                </div>
                <div class="col-md-12 prev-clicked">
                    <label for="Email" class="form-label">Email</label>
                    <div class="input-group">
                        <span class="input-group-text">@</span>
                        <input type="text" class="form-control" id="Email" aria-describedby="inputGroupPrepend">
                    </div>
                    <div class="good-val-eu alert alert-success d-none">Looks good!</div>
                    <div class="bad-val-eu alert alert-danger d-none"></div>
                </div>
                <div class="col-md-6 d-none next-clicked">
                    <label for="Password" class="form-label">Password</label>
                    <input type="password" class="form-control" id="Password">
                    <div class="good-val-pu alert alert-success d-none">Looks good!</div>
                    <div class="bad-val-pu alert alert-danger d-none"></div>
                </div>
                <div class="col-md-6 d-none next-clicked">
                    <label for="Valid-Password" class="form-label">Valid Password</label>
                    <input type="password" class="form-control" id="Valid-Password">
                    <div class="good-val-vpu alert alert-success d-none">Looks good!</div>
                    <div class="bad-val-vpu alert alert-danger d-none"></div>
                </div>
                <div class="col-md-6 d-none next-clicked">
                    <label for="Date-Of-Birth" class="form-label">Date Of Birth</label>
                    <input type="date" class="form-control" id="Date-Of-Birth">
                    <div class="good-val-du alert alert-success d-none">Looks good!</div>
                    <div class="bad-val-du alert alert-danger d-none"></div>
                </div>
                <div class="col-md-6 d-none next-clicked">
                    <label for="Gender" class="form-label">Gender</label>
                    <select class="form-select" aria-label="Default select example" id="Gender">
                        <option selected>Select your gender</option>
                        <option value="1">Male</option>
                        <option value="2">Female</option>
                        <option value="3">Other</option>
                    </select>
                    <div class="good-val-gu alert alert-success d-none">Looks good!</div>
                    <div class="bad-val-gu alert alert-danger d-none"></div>
                </div>
                <div class="col-12 d-none next-clicked">
                    <div class="input-group">
                        <span class="input-group-text">Comments</span>
                        <textarea class="form-control Comments-elem" aria-label="Comments"></textarea>
                    </div>
                    <div class="bad-val-cu alert alert-danger d-none"></div>
                </div>
                <div class="col-12 text-center">
                    <button class="btn btn-primary go-prev next-clicked d-none" type="button">Back</button>
                    <button class="btn btn-primary sub-next" type="button">Next</button>
                </div>
            </form>
        </div>
        <div class="col-4"></div>
    </div>

    <!-- SignUp -->
    <div class="row">
        <div class="col-12">
            <a></a>
        </div>
    </div>
</div>

<script>
    const PAGE_1 = 0;
    const emails = JSON.parse(localStorage.getItem("storedEmails")) || {};
    const save_email = () =>{
        emails[document.getElementById("Email").value.trim()] = {
            first_name: document.getElementById("First-Name").value.trim(),
            last_name: document.getElementById("Last-Name").value.trim(),
            password: document.getElementById("Password").value.trim(),
            date: document.getElementById("Date-Of-Birth").value.trim(),
            gender: document.getElementById("Gender").value.trim(),
            text: document.querySelector("textarea").value.trim(),
        };
        localStorage.setItem("storedEmails",JSON.stringify(emails));
    }
    document.addEventListener('DOMContentLoaded', function(){
        // Example starter JavaScript for disabling form submissions if there are invalid fields
        (() => {
            let page_num = 0;
            const az_pattern = /[a-z]+/;
            const email_pattern = /\S+@\S+ac\.il/;
            const password_pattern = /^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}$/;

            const elem_next_none = document.querySelectorAll('.next-clicked');
            const elem_prev_none = document.querySelectorAll('.prev-clicked');

            const sub_next = document.querySelector(".sub-next");

            sub_next.addEventListener("click", function(event){
                const email_ev = document.getElementById("Email").value.trim();
                const first_name_ev = document.getElementById("First-Name").value.trim();
                const last_name_ev = document.getElementById("Last-Name").value.trim();

                let is_valid = true;

                if (page_num === PAGE_1) {
                    // first name validation
                    if(!first_name_ev) {
                        const first_name_alert = document.querySelector(".bad-val-fu");
                        first_name_alert.innerHTML = "The first name must not be empty";
                        first_name_alert.classList.remove("d-none")

                        is_valid = false;
                    }
                    else if(!az_pattern.test(first_name_ev)) {
                        const first_name_alert = document.querySelector(".bad-val-fu");
                        first_name_alert.innerHTML = "The first name should only contain alphabets (a-z)";
                        first_name_alert.classList.remove("d-none")

                        is_valid = false;
                    }
                    else {
                        let first_name_alert = document.querySelector(".bad-val-fu");
                        first_name_alert.innerHTML = "";
                        first_name_alert.classList.add("d-none")

                        first_name_alert = document.querySelector(".good-val-fu");
                        first_name_alert.classList.remove("d-none")
                    }

                    // last name validation
                    if(!last_name_ev) {
                        const last_name_alert = document.querySelector(".bad-val-lu");
                        last_name_alert.innerHTML = "The last name must not be empty";
                        last_name_alert.classList.remove("d-none")

                        is_valid = false;
                    }
                    else if(!az_pattern.test(last_name_ev))
                    {
                        const last_name_alert = document.querySelector(".bad-val-lu");
                        last_name_alert.innerHTML = "The last name should only contain alphabets (a-z)";
                        last_name_alert.classList.remove("d-none")

                        is_valid = false;
                    }
                    else
                    {
                        let last_name_alert = document.querySelector(".bad-val-lu");
                        last_name_alert.innerHTML = "";
                        last_name_alert.classList.add("d-none")

                        last_name_alert = document.querySelector(".good-val-lu");
                        last_name_alert.classList.remove("d-none")
                    }

                    //email validation
                    if(!email_ev) {
                        const email_alert = document.querySelector(".bad-val-eu");
                        email_alert.innerHTML = "The Email must not be empty";
                        email_alert.classList.remove("d-none")

                        is_valid = false;
                    }
                    else if(email_ev in emails) {
                        const email_alert = document.querySelector(".bad-val-eu");
                        email_alert.innerHTML = "The Email should be unique, one cannot record more than one user with same email.";
                        email_alert.classList.remove("d-none")

                        is_valid = false;
                    }
                    else if(!email_pattern.test(email_ev))
                    {
                        const email_alert = document.querySelector(".bad-val-eu");
                        email_alert.innerHTML = "The Email should contain a valid email address from an Israeli academic institution (*.ac.il)";
                        email_alert.classList.remove("d-none")

                        is_valid = false;
                    }
                    else{
                        let email_alert = document.querySelector(".bad-val-eu");
                        email_alert.innerHTML = "";
                        email_alert.classList.add("d-none")

                        email_alert = document.querySelector(".good-val-eu");
                        email_alert.classList.remove("d-none")
                    }


                    if(is_valid)
                    {
                        elem_next_none.forEach(div => {
                            div.classList.remove('d-none');
                        });

                        elem_prev_none.forEach(div => {
                            div.classList.add('d-none');
                        });

                        sub_next.innerHTML = "Submit";
                        ++page_num;
                    }
                }
                else
                {
                    const password_ev = document.getElementById("Password").value.trim();
                    const confirm_password_ev = document.getElementById("Valid-Password").value.trim();
                    const date_ev = document.getElementById("Date-Of-Birth").value.trim();
                    const gender_ev = document.getElementById("Gender").value.trim();
                    const text_ev = document.querySelector("textarea").value.trim();

                    // password validation
                    if(!password_ev) {
                        const password_alert = document.querySelector(".bad-val-pu");
                        password_alert.innerHTML = "The password must not be empty";
                        password_alert.classList.remove("d-none")

                        is_valid = false;
                    } else if(!password_pattern.test(password_ev)) {
                        const password_alert = document.querySelector(".bad-val-pu");
                        password_alert.innerHTML = "The password should only contain at least one uppercase letter(A-Z), one lowercase letter (a-z) and one digit.";
                        password_alert.classList.remove("d-none")

                        if(password_ev.length<8)
                            password_alert.innerHTML += " <b>minimum eight characters<b>";

                        is_valid = false;
                    } else if(password_ev.length<8) {
                        const password_alert = document.querySelector(".bad-val-pu");
                        password_alert.innerHTML = "<b>minimum eight characters<b>";
                        password_alert.classList.remove("d-none")
                        is_valid = false;
                    } else {
                        let password_alert = document.querySelector(".bad-val-pu");
                        password_alert.innerHTML = "";
                        password_alert.classList.add("d-none")

                        password_alert = document.querySelector(".good-val-pu");
                        password_alert.classList.remove("d-none")
                    }


                    // valid password validation
                    if(!confirm_password_ev) {
                        const valid_password_alert = document.querySelector(".bad-val-vpu");
                        valid_password_alert.innerHTML = "The Valid password must not be empty";
                        valid_password_alert.classList.remove("d-none")

                        is_valid = false;
                    } else if(!confirm_password_ev === password_ev) {
                        const valid_password_alert = document.querySelector(".bad-val-vpu");
                        valid_password_alert.innerHTML = "The Valid password must match the first password field";

                        is_valid = false;
                    } else {
                        let valid_password_alert = document.querySelector(".bad-val-vpu");
                        valid_password_alert.innerHTML = "";
                        valid_password_alert.classList.add("d-none")

                        valid_password_alert = document.querySelector(".good-val-vpu");
                        valid_password_alert.classList.remove("d-none")
                    }

                    // date validation
                    console.log(date_ev)
                    if(!date_ev) {
                        const date_alert = document.querySelector(".bad-val-du");
                        date_alert.innerHTML = "The date must not be empty";
                        date_alert.classList.remove("d-none")

                        is_valid = false;
                    } else
                    {
                        const dateObject = new Date(date_ev); // make date value
                        if (!isNaN(dateObject.getTime())/*check if the date input is valid*/)
                        {
                            const currentDate = new Date();
                            const userBirthDate = new Date(dateObject.getFullYear() + 18, dateObject.getMonth(), dateObject.getDate());

                            if (userBirthDate > currentDate)
                            {
                                const date_alert = document.querySelector(".bad-val-du");
                                date_alert.innerHTML = "The user date must be at least 18 years old";
                                date_alert.classList.remove("d-none")

                                is_valid = false
                            }
                            else {
                                let date_alert = document.querySelector(".bad-val-du");
                                date_alert.innerHTML = "";
                                date_alert.classList.add("d-none")

                                date_alert = document.querySelector(".good-val-du");
                                date_alert.classList.remove("d-none")
                            }
                        }else
                        {
                            const date_alert = document.querySelector(".bad-val-du");
                            date_alert.innerHTML = "the date input is not valid";
                            date_alert.classList.remove("d-none")

                            is_valid = false
                        }
                    }

                    // gender validation
                    if(gender_ev === 'Select your gender') {
                        const gender_alert = document.querySelector(".bad-val-gu");
                        gender_alert.innerHTML = "You must to choose your Gender!";
                        gender_alert.classList.remove("d-none")

                        is_valid = false;
                    } else {
                        let gender_alert = document.querySelector(".bad-val-gu");
                        gender_alert.innerHTML = "";
                        gender_alert.classList.add("d-none")

                        gender_alert = document.querySelector(".good-val-gu");
                        gender_alert.classList.remove("d-none")
                    }


                    if(text_ev.length > 100){
                        const comment_alert = document.querySelector(".bad-val-cu");
                        comment_alert.innerHTML = "maximum of 100 characters";
                        comment_alert.classList.remove("d-none")

                        is_valid = false;
                    } else{
                        const comment_alert = document.querySelector(".bad-val-cu");
                        comment_alert.innerHTML = "";
                        comment_alert.classList.add("d-none")
                    }

                    if(is_valid){
                        // emails.email_ev = {
                        //     first_name: first_name_ev,
                        //     last_name: last_name_ev,
                        //     password: password_ev,
                        //     date: date_ev,
                        //     gender: gender_ev,
                        //     text: text_ev,
                        // };

                        sub_next.type = "submit"
                    }
                }
            })

            document.querySelector(".go-prev").addEventListener("click", function(event){
                elem_prev_none.forEach(div => {
                    div.classList.remove('d-none');
                });

                elem_next_none.forEach(div => {
                    div.classList.add('d-none');
                });

                --page_num;
                document.querySelector('div .sub-next').innerHTML = "Next";
            })

        })()
    })
</script>
<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
<script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
</body>
</html>