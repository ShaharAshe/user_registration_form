<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet" integrity="sha384-T3c6CoIi6uLrA9TneNEoa7RxnatzjcDSCmG1MXxSR1GAsXEV/Dwwykc2MPK8M2HN" crossorigin="anonymous">
        <title>replace the title</title>
    </head>
    <body>
        <div class="container-fluid">
            <!-- 1 -->
            <div class="row">
                <div class="col-12 text-center bg-info">
                    <h2>LogIn</h2>
                </div>
            </div>

            <!-- The form -->
            <div class="row">
                <div class="col-12">
                    <form class="row g-3 needs-validation" method="post" action="#" onsubmit="save_email()">
                        <div class="col-md-6 prev-clicked">
                            <label for="First-Name" class="form-label">First name</label>
                            <input type="text" class="form-control" id="First-Name">
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                        <div class="col-md-6 prev-clicked">
                            <label for="Last-Name" class="form-label">Last name</label>
                            <input type="text" class="form-control" id="Last-Name">
                            <div class="valid-feedback">Looks good!</div>
                        </div>
                        <div class="col-md-12 prev-clicked">
                            <label for="Email" class="form-label">Email</label>
                            <div class="input-group has-validation">
                                <span class="input-group-text">@</span>
                                <input type="text" class="form-control" id="Email" aria-describedby="inputGroupPrepend">
                                <div class="invalid-feedback">Please choose a username.</div>
                            </div>
                        </div>
                        <div class="col-md-3 d-none next-clicked">
                            <label for="Password" class="form-label">Password</label>
                            <input type="password" class="form-control" id="Password">
                            <div class="invalid-feedback">Please provide a valid city.</div>
                        </div>
                        <div class="col-md-3 d-none next-clicked">
                            <label for="Valid-Password" class="form-label">Valid Password</label>
                            <input type="password" class="form-control" id="Valid-Password">
                            <div class="invalid-feedback">Please provide a valid city.</div>
                        </div>
                        <div class="col-md-3 d-none next-clicked">
                            <label for="Date-Of-Birth" class="form-label">Date Of Birth</label>
                            <input type="text" class="form-control" id="Date-Of-Birth">
                            <div class="invalid-feedback">Please provide a valid city.</div>
                        </div>
                        <div class="col-md-3 d-none next-clicked">
                            <label for="Gender" class="form-label">Gender</label>
                            <select class="form-select" aria-label="Default select example" id="Gender">
                                <option selected>Select your gender</option>
                                <option value="1">Male</option>
                                <option value="2">Female</option>
                                <option value="3">Other</option>
                            </select>
                        </div>
                        <div class="col-6 d-none next-clicked">
                            <div class="input-group">
                                <span class="input-group-text">Comments</span>
                                <textarea class="form-control Comments-elem" aria-label="Comments"></textarea>
                            </div>
                        </div>
                        <div class="col-12">
                            <button class="btn btn-primary go-prev" type="button">Back</button>
                            <button class="btn btn-primary sub-next" type="button">Next</button>
                        </div>
                    </form>
                </div>
            </div>

            <!-- SignUp -->
            <div class="row">
                <div class="col-12">
                    <a></a>
                </div>
            </div>
        </div>

        <script>
            const PAGE_1 = 0;

            const emails = JSON.parse(localStorage.getItem("storedEmails")) || [];
            const save_email = () =>{
                emails.push(document.getElementById("Email").value);

                localStorage.setItem("storedEmails",JSON.stringify(emails));
            }
            document.addEventListener('DOMContentLoaded', function(){
                // Example starter JavaScript for disabling form submissions if there are invalid fields
                (() => {
                    let page_num = 0;
                    const az_pattern = /[a-z]+/;
                    const email_pattern = /\S+@\S+ac\.il/;
                    const password_pattern = /^(?=.*[A-Z])(?=.*[a-z])(?=.*\d).{8,}$/;

                    const forms = document.querySelectorAll('.needs-validation');
                    const elem_next_none = document.querySelectorAll('.next-clicked');
                    const elem_prev_none = document.querySelectorAll('.prev-clicked');

                    const sub_next = document.querySelector(".sub-next");

                    sub_next.addEventListener("click", function(event){
                        const email_ev = document.getElementById("Email").value;

                        if (page_num === PAGE_1) {
                            const first_name_ev = document.getElementById("First-Name").value;
                            const last_name_ev = document.getElementById("Last-Name").value;

                            console.log(emails)
                            if (az_pattern.test(first_name_ev)
                                && az_pattern.test(last_name_ev)
                                && email_pattern.test(email_ev)
                                &&  !emails.includes(email_ev))
                            {
                                elem_next_none.forEach(div => {
                                    div.classList.remove('d-none');
                                });

                                elem_prev_none.forEach(div => {
                                    div.classList.add('d-none');
                                });

                                sub_next.innerHTML = "Submit";
                                ++page_num;
                            }
                        }
                        else
                        {
                            const password_ev = document.getElementById("Password").value;
                            const confirm_password_ev = document.getElementById("Password").value;
                            const date_ev = document.getElementById("Date-Of-Birth").value;
                            const gender_ev = document.getElementById("Gender").value;
                            const text_ev = document.querySelector("textarea").textLength;

                            if ((gender_ev === '1' || gender_ev === '2' || gender_ev === '2')
                                && date_ev
                            && text_ev <= 100)
                            {
                                console.log("111")
                                const dateObject = new Date(date_ev); // make date value
                                if (!isNaN(dateObject.getTime())/*check if the date input is valid*/)
                                {
                                    console.log("222")
                                    const currentDate = new Date();
                                    const userBirthDate = new Date(dateObject.getFullYear() + 18, dateObject.getMonth(), dateObject.getDate());

                                    if (password_pattern.test(password_ev)
                                        && confirm_password_ev === password_ev
                                        && userBirthDate <= currentDate)
                                    {
                                        console.log("333")
                                        emails.push(email_ev);
                                        console.log(emails)
                                        sub_next.type = "submit"
                                    }
                                }
                            }
                        }
                    })

                    document.querySelector(".go-prev").addEventListener("click", function(event){
                        elem_prev_none.forEach(div => {
                            div.classList.remove('d-none');
                        });

                        elem_next_none.forEach(div => {
                            div.classList.add('d-none');
                        });

                        --page_num;
                        document.querySelector('div .sub-next').innerHTML = "Next";
                    })

                })()
            })
        </script>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-C6RzsynM9kWDrMNeT87bh95OGNyZPhcTNXj1NW7RuBCsyN/o0jlpcV8Qyq46cDfL" crossorigin="anonymous"></script>
        <script src="https://cdn.jsdelivr.net/npm/@popperjs/core@2.11.8/dist/umd/popper.min.js" integrity="sha384-I7E8VVD/ismYTF4hNIPjVp/Zjvgyol6VFvRkX/vR+Vc4jQkC+hVqc2pM8ODewa9r" crossorigin="anonymous"></script>
    </body>
</html>
